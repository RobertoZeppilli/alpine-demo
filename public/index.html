<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <title>Document</title>
</head>

<body>
    <main class="p-5">
        <!-- counter -->
        <section class="bg-green-200">
            <h2 class="font-bold md:text-2xl mb-10">🌠 Counter 🌠</h2>
            <div class="counter" x-data="{ count: 0 }">
                <button class="btn" @click="count++">
                    Increment
                </button>
                <span x-text="count"></span>
            </div>
        </section>
        <!-- END counter -->

        <!-- dropdown -->
        <section class="bg-blue-200">
            <h2 class="font-bold md:text-2xl mb-10">🌌 Dropdown 🌌</h2>
            <div class="dropdown py-10" x-data="{ isOpen: false }">
                <button class="btn" @click="isOpen = !isOpen" x-text="isOpen ? `hide` : `show`">
                </button>
                <span
                    class="text-sm md:text-2xl font-semibold"
                    x-transition:enter="transition ease-out duration-300"
                    x-transition:enter-start="opacity-0 scale-90"
                    x-transition:enter-end="opacity-100 scale-100"
                    x-transition:leave="transition ease-in duration-300"
                    x-transition:leave-start="opacity-100 scale-100"
                    x-transition:leave-end="opacity-0 scale-90"
                    x-show="isOpen"
                    @click.outside="isOpen = false">
                    I ❤️ Alpine
                </span>
            </div>
        </section>
        <!-- END dropdown -->

        <!-- search-input -->
        <section class="bg-orange-200">
            <h2 class="font-bold md:text-2xl mb-10">🧩 Search Input Filter 🧩</h2>
            <div class="search-input" x-data>
                <input x-model="$store.data.search" placeholder="Search...">

                <ul>
                    <template x-for="item in $store.data.filteredItems" :key="item">
                        <li x-text="item"></li>
                    </template>
                </ul>
            </div>
        </section>
        <!-- END search-input -->

        <!-- dark mode -->
        <section :class="$store.data.toggle ? 'bg-white-200 text-zinc-900' : 'bg-zinc-900 text-white'"
            class="flex flex-col md:flex-row items-center justify-between" x-data>
            <h2 class="font-bold md:text-2xl mb-5 md:mb-0">🌘 Dark Mode Toggle 🌘</h2>
            <input type="checkbox" id="toggle" class="toggle--checkbox" @click="$store.data.toggleDark()">
            <label for="toggle" class="toggle--label">
                <span class="toggle--label-background"></span>
            </label>
        </section>
        <!-- END dark mode -->


        <!-- JSON -->
        <section class="flex flex-col" :class="$store.data.NaN ? 'bg-red-200' : 'bg-violet-200'" x-data>
            <h2 class="font-bold md:text-2xl mb-10">📊 JSON Data 📊</h2>

            <small
                class="font-bold"
                :class="$store.data.NaN ? 'text-red-600' : 'text-green-600'"
                x-text="$store.data.NaN ? 'Please Enter a Number!' : 'Insert a Number and get the phrase!'"
            ></small>

            <div class="py-5 flex">
                <input
                    class="json-input"
                    x-model="$store.data.jsonSearch"
                    placeholder="Search..."
                >
                <button
                    class="btn-no-radius bg-zinc-900"
                    type="submit"
                    @click="$store.data.fetchData()"
                >Send</button>
            </div>
            <p
                class="md:text-2xl font-semibold"
                x-show="$store.data.placeholder.title && !$store.data.NaN"
                x-text="$store?.data?.placeholder?.title"
                x-transition:enter="transition ease-in-out duration-300"
                x-transition:enter-start="opacity-0 scale-30"
                x-transition:enter-end="opacity-100 scale-100"
                x-transition:leave="transition ease-in-out duration-300"
                x-transition:leave-start="opacity-100 scale-100"
                x-transition:leave-end="opacity-0 scale-30"
            ></p>
        </section>
        <!-- END JSON -->
    </main>

    <script>

        document.addEventListener('alpine:init', () => {
            Alpine.store('data', {

                // input search filter
                search: "",
                items: ["Foo", "Baz", "Bar"],

                // act as a computed property
                get filteredItems() {
                    return this.items.filter(item => item.toLowerCase().startsWith(this.search.toLocaleLowerCase()))
                },
                // end: input search filter


                // dark mode
                toggle: false,
                toggleDark() {
                    this.toggle = !this.toggle
                },
                // end: dark mode

                // json
                jsonSearch: "",
                placeholder: {},
                Nan: false,
                maxNumber: false,
                async fetchData() {
                    if (this.jsonSearch === "") {
                        return
                    }

                    if (isNaN(Number(this.jsonSearch))) {
                        this.NaN = true
                        return
                    }

                    if(Number(this.jsonSearch) > 200) {
                        this.maxNumber = true
                        return
                    }


                    try {
                        this.NaN = false
                        this.maxNumber = false
                        const response = await fetch(`https://jsonplaceholder.typicode.com/todos/${this.jsonSearch}`)
                        const data = await response.json()
                        this.placeholder = data
                    } catch (error) {
                        console.log(error)
                    }
                },

                init() {
                    this.NaN = false
                    this.maxNumber = false
                }

            })
        })

    </script>
</body>

</html>